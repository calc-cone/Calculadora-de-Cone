<!DOCTYPE html>
<html lang="en">
	<head>
		<title>cone</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="main.css">

	</head>

	<body>
        <script>
            // Coloca um texto antes disso dizendo pra colocar 0 caso não tiver o valor
            // Todos os numeros estao em float
            var raio = parseFloat(prompt("Raio: "));
            var diametro = parseFloat(prompt("Diâmetro:"));
            var altura = parseFloat(prompt("Altura: "));
            var geratriz = parseFloat(prompt("Geratriz: "));
			if (raio == 0) {
				raio = diametro / 2;
			}
			if (diametro == 0) {
				diametro = raio * 2;
			}
			if (altura == 0) {
                altura = Math.sqrt(geratriz ** 2 - raio ** 2);
            } 
            if (geratriz == 0) {
                geratriz = Math.sqrt(altura ** 2 + raio ** 2);
            }
            //^ Contas para descobrir variaveis restantes
            //Tenta fazer com que dê erro se ambos raio e diametro forem 0 ou se ambos altura e geratriz forem 0
            var volume = (Math.PI * raio ** 2 * altura) / 3;
            var area = Math.PI * raio * (raio + geratriz);
            //Math.PI é pi se não for obvio

           
            
        </script>
        <button onclick="cone3d()">Continuar</button>

		<script type="importmap">
			{
				"imports": {
					"three": "../build/three.module.js",
					"three/addons/": "./jsm/"
				}
			}
		</script>

        <script type="module">
            import * as THREE from 'three';
            import { AsciiEffect } from 'three/addons/effects/AsciiEffect.js';
            import { TrackballControls } from 'three/addons/controls/TrackballControls.js';

            function cone3d() {
                // Coloca o valor do volume e da area em um lugar visivel
                document.getElementById("volume").innerHTML = "Volume: " + volume;
                document.getElementById("area").innerHTML = "Área: " + area;
                // Coloca o valor do raio, altura e geratriz em um lugar visivel
                document.getElementById("raio").innerHTML = "Raio: " + raio;
                document.getElementById("altura").innerHTML = "Altura: " + altura;
                document.getElementById("geratriz").innerHTML = "Geratriz: " + geratriz;
                document.getElementById("diametro").innerHTML = "Diâmetro: " + diametro;

                let camera, controls, scene, renderer, effect;

                let cone, plane;

                const start = Date.now();

                init();

                function init() {

                    camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 1, 1000 );
                    camera.position.y = 150;
                    camera.position.z = 500;

                    scene = new THREE.Scene();
                    scene.background = new THREE.Color( 0, 0, 0 );

                    const pointLight1 = new THREE.PointLight( 0xffffff, 3, 0, 0 );
                    pointLight1.position.set( 500, 500, 500 );
                    scene.add( pointLight1 );

                    const pointLight2 = new THREE.PointLight( 0xffffff, 1, 0, 0 );
                    pointLight2.position.set( - 500, - 500, - 500 );
                    scene.add( pointLight2 );

                    cone = new THREE.Mesh( new THREE.ConeGeometry( raio, altura, 322), new THREE.MeshPhongMaterial( { flatShading: true } ) );
                    scene.add( cone );

                    // Plane

                    plane = new THREE.Mesh( new THREE.PlaneGeometry( 400, 400 ), new THREE.MeshBasicMaterial( { color: 0xe0e0e0 } ) );
                    plane.position.y = - 200;
                    plane.rotation.x = - Math.PI / 2;
                    scene.add( plane );

                    renderer = new THREE.WebGLRenderer();
                    renderer.setSize( window.innerWidth, window.innerHeight );
                    renderer.setAnimationLoop( animate );

                    effect = new AsciiEffect( renderer, ' .:-+*=%@#', { invert: true } );
                    effect.setSize( window.innerWidth, window.innerHeight );
                    effect.domElement.style.color = 'white';
                    effect.domElement.style.backgroundColor = 'black';

                    // Special case: append effect.domElement, instead of renderer.domElement.
                    // AsciiEffect creates a custom domElement (a div container) where the ASCII elements are placed.

                    document.body.appendChild( effect.domElement );

                    controls = new TrackballControls( camera, effect.domElement );

                    //

                    window.addEventListener( 'resize', onWindowResize );

                }

                function onWindowResize() {

                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();

                    renderer.setSize( window.innerWidth, window.innerHeight );
                    effect.setSize( window.innerWidth, window.innerHeight );

                }

                //

                function animate() {

                    const timer = Date.now() - start;

                    cone.position.y = Math.abs( Math.sin( timer * 0.002 ) ) * 150;
                    cone.rotation.x = timer * 0.0003;
                    cone.rotation.z = timer * 0.0002;

                    controls.update();

                    effect.render( scene, camera );
			}
                
            

			}
            
			
        
		</script>

	</body>
</html>